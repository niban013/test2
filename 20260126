var table = $('#example').DataTable({
    dom:
        "<'row align-items-center mb-2'<'col-md-6'i><'col-md-6 d-flex justify-content-end align-items-center gap-2'fB>>" +
        "<'row'<'col-12'tr>>" +
        "<'row mt-2'<'col-md-5'l><'col-md-7'p>>",

    buttons: [
        { extend: 'excelHtml5', text: 'åŒ¯å‡º Excel', className: 'btn btn-success btn-sm' },
        { extend: 'csvHtml5',   text: 'åŒ¯å‡º CSV',   className: 'btn btn-primary btn-sm' }
    ]
});

table.on('draw', function () {
    const hasData = table.rows({ filter: 'applied' }).any();

    // index 0 = Excel
    table.button(0).node().style.display = hasData ? 'inline-block' : 'none';
});
buttons: [
    { extend: 'excelHtml5', text: 'åŒ¯å‡º Excel', className: 'btn btn-success btn-sm', name: 'excelBtn' },
    { extend: 'csvHtml5',   text: 'åŒ¯å‡º CSV',   className: 'btn btn-primary btn-sm', name: 'csvBtn' }
]
table.on('draw', function () {
    const hasData = table.rows({ filter: 'applied' }).any();

    table.button('excelBtn:name').node().style.display = hasData ? 'inline-block' : 'none';
});


const count = table.rows({ filter: 'applied' }).count();
table.button('excelBtn:name').node().style.display = count > 0 ? 'inline-block' : 'none';


åŸºæœ¬å¯«æ³•

å‡è¨­ä½ å·²ç¶“æœ‰ä¸€å€‹ functionï¼š

function myExportLogic() {
    alert("åŸ·è¡Œè‡ªè¨‚åŒ¯å‡ºé‚è¼¯ï¼");
}


Button é€™æ¨£å¯«ï¼š

buttons: [
    {
        text: 'è‡ªè¨‚åŒ¯å‡º',
        className: 'btn btn-warning btn-sm',
        action: function (e, dt, node, config) {
            myExportLogic(); // ğŸ‘ˆ å‘¼å«ä½ è‡ªå·±çš„ function
        }
    }
]

âœ… å¦‚æœä½ é‚„æƒ³ã€Œå…ˆåšè‡ªè¨‚é‚è¼¯ï¼Œå†åŸ·è¡ŒåŸæœ¬ Excel åŒ¯å‡ºã€
function beforeExportCheck() {
    console.log("åŒ¯å‡ºå‰æª¢æŸ¥å®Œæˆ");
}

{
    extend: 'excelHtml5',
    text: 'åŒ¯å‡º Excel',
    className: 'btn btn-success btn-sm',
    action: function (e, dt, node, config) {

        beforeExportCheck(); // ğŸ‘ˆ å…ˆè·‘ä½ è‡ªå·±çš„ function

        // ğŸ‘‡ å†å‘¼å« DataTables å…§å»ºçš„ Excel åŒ¯å‡º
        $.fn.dataTable.ext.buttons.excelHtml5.action.call(this, e, dt, node, config);
    }
}

âœ… æŠŠ DataTable ç‰©ä»¶å‚³é€²ä½ çš„ function

å¾ˆå¤šæ™‚å€™ä½ éœ€è¦ç›®å‰è¡¨æ ¼è³‡æ–™ï¼š

function exportSelectedRows(table) {
    const data = table.rows({ selected: true }).data().toArray();
    console.log("é¸å–çš„è³‡æ–™ï¼š", data);
}

{
    text: 'åŒ¯å‡ºé¸å–è³‡æ–™',
    className: 'btn btn-info btn-sm',
    action: function (e, dt, node, config) {
        exportSelectedRows(dt); // dt å°±æ˜¯ DataTable instance
    }
}

ğŸ§  action åƒæ•¸æ˜¯ä»€éº¼ï¼Ÿ
åƒæ•¸	èªªæ˜
e	click event
dt	DataTable API ç‰©ä»¶ï¼ˆè¶…å¥½ç”¨ï¼‰
node	æŒ‰éˆ• DOM
config	æŒ‰éˆ•è¨­å®š
ğŸ¯ æœ€å¸¸è¦‹æ‡‰ç”¨
éœ€æ±‚	å¯«æ³•
å‘¼å«è‡ªè¨‚ function	myFunc();
å‚³ table é€²å»	myFunc(dt);
å…ˆæª¢æŸ¥å†åŒ¯å‡º	è‡ªè¨‚é‚è¼¯ + excelHtml5.action.call(...)

å¦‚æœä½ æŠŠä½ é‚£å€‹ å·²ç¶“å¯«å¥½çš„ function è²¼çµ¦æˆ‘ï¼Œæˆ‘å¯ä»¥å¹«ä½ æ”¹æˆã€ŒæŒ‰ä¸‹æŒ‰éˆ• â†’ æ­£ç¢ºå¸¶å…¥ DataTable è³‡æ–™ã€çš„ç‰ˆæœ¬ã€‚


<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>DataTable Export Demo</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- DataTables -->
    <link href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
    <link href="https://cdn.datatables.net/buttons/2.4.2/css/buttons.dataTables.min.css" rel="stylesheet">
</head>
<body class="p-4">

    <div class="container">
        <h3 class="mb-3">å“¡å·¥æ¸…å–®</h3>

        <table id="example" class="table table-striped" style="width:100%">
            <thead>
                <tr>
                    <th>å§“å</th>
                    <th>è·ç¨±</th>
                    <th>åŸå¸‚</th>
                    <th>å¹´é½¡</th>
                    <th>åˆ°è·æ—¥</th>
                    <th>è–ªè³‡</th>
                </tr>
            </thead>
            <tbody>
                <tr><td>ç‹å°æ˜</td><td>å·¥ç¨‹å¸«</td><td>å°åŒ—</td><td>28</td><td>2020/03/12</td><td>50,000</td></tr>
                <tr><td>æå°è¯</td><td>è¨­è¨ˆå¸«</td><td>å°ä¸­</td><td>32</td><td>2019/07/01</td><td>48,000</td></tr>
                <tr><td>é™³å¤§æ–‡</td><td>å°ˆæ¡ˆç¶“ç†</td><td>é«˜é›„</td><td>40</td><td>2018/01/15</td><td>75,000</td></tr>
                <tr><td>æ—ç¾éº—</td><td>è¡ŒéŠ·</td><td>å°åŒ—</td><td>29</td><td>2021/11/20</td><td>45,000</td></tr>
                <tr><td>å¼µå¿—å¼·</td><td>å·¥ç¨‹å¸«</td><td>æ–°ç«¹</td><td>35</td><td>2017/05/30</td><td>68,000</td></tr>
            </tbody>
        </table>
    </div>

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

    <!-- DataTables -->
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>

    <!-- Buttons -->
    <script src="https://cdn.datatables.net/buttons/2.4.2/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.html5.min.js"></script>

    <!-- Excel éœ€è¦ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>

    <script>
        $(document).ready(function () {
            var table = $('#example').DataTable({
                dom:
                    "<'row align-items-center mb-2'<'col-md-6'i><'col-md-6 d-flex justify-content-end align-items-center gap-2'fB>>" +
                    "<'row'<'col-12'tr>>" +
                    "<'row mt-2'<'col-md-5'l><'col-md-7'p>>",

                buttons: [
                    { extend: 'excelHtml5', text: 'åŒ¯å‡º Excel', className: 'btn btn-success btn-sm' },
                    { extend: 'csvHtml5', text: 'åŒ¯å‡º CSV', className: 'btn btn-primary btn-sm' }
                ]
            });
        });
    </script>

</body>
</html>

