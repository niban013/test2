<input type="file" id="fileUpload" accept="image/*" />
<button id="btnUpload">ä¸Šå‚³</button>
<div id="preview"></div>
<div id="result"></div>
[HttpPost("upload")]
public async Task<IActionResult> Upload(IFormFile file)
{
    if (file == null || file.Length == 0)
        return BadRequest("æ²’æœ‰æª”æ¡ˆ");

    var path = Path.Combine("wwwroot/uploads", file.FileName);

    using (var stream = new FileStream(path, FileMode.Create))
    {
        await file.CopyToAsync(stream);
    }

    return Ok(new { filePath = "/uploads/" + file.FileName });
}

$(document).ready(function () {
    let selectedFile = null;

    // å³æ™‚é è¦½
    $("#fileUpload").on("change", function () {
        selectedFile = this.files[0];
        if (selectedFile) {
            var reader = new FileReader();
            reader.onload = function (e) {
                $("#preview").html(
                    '<img src="' + e.target.result + '" style="max-width:200px; border:1px solid #ccc; border-radius:8px; padding:4px;">'
                );
            };
            reader.readAsDataURL(selectedFile);
        }
    });

    // ä¸Šå‚³åˆ°å¾Œç«¯
    $("#btnUpload").on("click", function () {
        if (!selectedFile) {
            alert("è«‹å…ˆé¸æ“‡åœ–ç‰‡");
            return;
        }

        var formData = new FormData();
        formData.append("file", selectedFile);

        $.ajax({
            url: "/upload",   // ğŸš¨ æ”¹æˆä½ çš„å¾Œç«¯ API è·¯å¾‘
            type: "POST",
            data: formData,
            contentType: false,
            processData: false,
            success: function (res) {
                $("#result").html("<p style='color:green'>ä¸Šå‚³æˆåŠŸï¼ä¼ºæœå™¨å›æ‡‰: " + res + "</p>");
            },
            error: function (err) {
                $("#result").html("<p style='color:red'>ä¸Šå‚³å¤±æ•—ï¼</p>");
                console.error(err);
            }
        });
    });
});
