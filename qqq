SELECT
    o.CustomerId,
    c.CustomerName,   -- é€£çµå¦ä¸€è¡¨
    -- ç‹€æ…‹ç‚º Completed æˆ– Shipped çš„ç¸½é‡‘é¡
    SUM(CASE WHEN o.Status IN ('Completed', 'Shipped') THEN o.Amount ELSE 0 END) AS CompletedShippedTotal,
    -- ç‹€æ…‹ç‚º Pending çš„ç¸½é‡‘é¡
    SUM(CASE WHEN o.Status = 'Pending' THEN o.Amount ELSE 0 END) AS PendingTotal,
    -- ç‹€æ…‹ç‚º Cancelled æˆ– Refunded çš„ç¸½é‡‘é¡
    SUM(CASE WHEN o.Status IN ('Cancelled', 'Refunded') THEN o.Amount ELSE 0 END) AS CancelledRefundedTotal,
    -- å…¨éƒ¨é‡‘é¡ç¸½å’Œ
    SUM(o.Amount) AS TotalAmount
FROM Orders o
INNER JOIN Customers c ON o.CustomerId = c.CustomerId
GROUP BY o.CustomerId, c.CustomerName
ORDER BY o.CustomerId;


SELECT
    o.CustomerId,
    MAX(c.CustomerName) AS CustomerName,  -- å–å”¯ä¸€åç¨±
    SUM(CASE WHEN o.Status IN ('Completed', 'Shipped') THEN o.Amount ELSE 0 END) AS CompletedShippedTotal,
    SUM(CASE WHEN o.Status = 'Pending' THEN o.Amount ELSE 0 END) AS PendingTotal,
    SUM(CASE WHEN o.Status IN ('Cancelled', 'Refunded') THEN o.Amount ELSE 0 END) AS CancelledRefundedTotal,
    SUM(o.Amount) AS TotalAmount
FROM Orders o
INNER JOIN Customers c ON o.CustomerId = c.CustomerId
GROUP BY o.CustomerId
ORDER BY o.CustomerId;

SELECT
    CustomerId,
    -- ç‹€æ…‹ç‚º Completed æˆ– Shipped çš„ç¸½é‡‘é¡
    SUM(CASE WHEN Status IN ('Completed', 'Shipped') THEN Amount ELSE 0 END) AS CompletedShippedTotal,
    
    -- ç‹€æ…‹ç‚º Pending çš„ç¸½é‡‘é¡
    SUM(CASE WHEN Status = 'Pending' THEN Amount ELSE 0 END) AS PendingTotal,
    
    -- ç‹€æ…‹ç‚º Cancelled æˆ– Refunded çš„ç¸½é‡‘é¡
    SUM(CASE WHEN Status IN ('Cancelled', 'Refunded') THEN Amount ELSE 0 END) AS CancelledRefundedTotal,
    
    -- å…¨éƒ¨é‡‘é¡ç¸½å’Œ
    SUM(Amount) AS TotalAmount
FROM Orders
GROUP BY CustomerId
ORDER BY CustomerId;
SUM(CASE WHEN Status IN ('Completed','Shipped') AND Amount > 100 THEN Amount ELSE 0 END) AS CompletedShippedOver100


WITH RankedOrders AS (
    SELECT
        CustomerId,
        OrderId,
        OrderDate,
        ROW_NUMBER() OVER (PARTITION BY CustomerId ORDER BY OrderDate DESC) AS rn
    FROM Orders
)
SELECT
    CustomerId,
    OrderId,
    OrderDate
FROM RankedOrders
WHERE rn = 1;
SELECT
    c.CustomerId,
    o.OrderId,
    o.OrderDate
FROM (
    SELECT DISTINCT CustomerId
    FROM Orders
) c
OUTER APPLY (
    SELECT TOP 1 *
    FROM Orders o
    WHERE o.CustomerId = c.CustomerId
    ORDER BY OrderDate DESC
) o;

SELECT o.*
FROM Orders o
INNER JOIN (
    SELECT CustomerId, MAX(OrderDate) AS MaxDate
    FROM Orders
    GROUP BY CustomerId
) t
ON o.CustomerId = t.CustomerId AND o.OrderDate = t.MaxDate;

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>dxSelectBox ç„¡é™æ»¾å‹•ç¤ºä¾‹</title>
    <link rel="stylesheet" href="https://cdn3.devexpress.com/jslib/22.2.6/css/dx.light.css">
 <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn3.devexpress.com/jslib/22.2.6/js/jszip.min.js"></script>
    <script src="https://cdn3.devexpress.com/jslib/22.2.6/js/dx.all.js"></script>
</head>
<body>

<h3>dxSelectBox ç„¡é™æ»¾å‹• + æœå°‹</h3>
<div id="dxSelectBox"></div>

<script>
$(function() {
    const totalData = Array.from({ length: 5000 }, (_, i) => ({ id: i + 1, name: "Item " + (i+1) }));
    const batchSize = 100;

    let loadedData = [];
    let currentIndex = 0;
    let currentSearch = "";

    function loadNextBatch(search = "") {
        let filtered = totalData;
        if (search) filtered = totalData.filter(x => x.name.toLowerCase().includes(search.toLowerCase()));
        const nextBatch = filtered.slice(currentIndex, currentIndex + batchSize);
        loadedData = loadedData.concat(nextBatch);
        currentIndex += batchSize;
        return nextBatch.length > 0;
    }

    const selectBox = $("#dxSelectBox").dxSelectBox({
        dataSource: loadedData,
        displayExpr: "name",
        valueExpr: "id",
        searchEnabled: true,
        showClearButton: true,
        deferRendering: true,
        dropDownOptions: {
            height: 300,
            onOpened: function(e) {
                const scrollable = e.component._dropDown.$content().find(".dx-scrollable-content");
                scrollable.off('scroll').on('scroll', function() {
                    if (scrollable.scrollTop() + scrollable.innerHeight() >= scrollable[0].scrollHeight - 5) {
                        if (loadNextBatch(currentSearch)) {
                            e.component.option('dataSource', loadedData);
                        }
                    }
                });
            }
        },
        onValueChanged: function(e) {
            e.component.close();
        },
        onInput: function(e) {
            currentSearch = e.component.option('searchValue') || "";
            loadedData = [];
            currentIndex = 0;
            loadNextBatch(currentSearch);
            e.component.option('dataSource', loadedData);
        }
    }).dxSelectBox('instance');

    // åˆå§‹è¼‰å…¥ç¬¬ä¸€æ‰¹
    loadNextBatch();
    selectBox.option('dataSource', loadedData);
});
</script>

</body>
</html>


// Controllers/EmployeeController.cs
using Microsoft.AspNetCore.Mvc;
using System.Collections.Generic;
using System.Linq;

public class Employee {
    public int Id { get; set; }
    public string Name { get; set; }
}

[ApiController]
[Route("api/[controller]")]
public class EmployeeController : ControllerBase
{
    // æ¨¡æ“¬ 5000 ç­†è³‡æ–™
    private static List<Employee> employees = Enumerable.Range(1, 5000)
        .Select(i => new Employee { Id = i, Name = "Employee " + i })
        .ToList();

    [HttpGet]
    public IActionResult Get(string search = "", int skip = 0, int take = 50)
    {
        var query = employees.AsQueryable();

        if (!string.IsNullOrWhiteSpace(search))
            query = query.Where(e => e.Name.Contains(search));

        var result = query.Skip(skip).Take(take).ToList();
        return Ok(result);
    }

    [HttpGet("{id}")]
    public IActionResult GetById(int id)
    {
        var emp = employees.FirstOrDefault(e => e.Id == id);
        if (emp == null) return NotFound();
        return Ok(emp);
    }
}
<div id="app">
    <div id="dxSelectBox"></div>
</div>

<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
<script src="https://cdn3.devexpress.com/jslib/23.1.4/js/dx.all.js"></script>
<link href="https://cdn3.devexpress.com/jslib/23.1.4/css/dx.light.css" rel="stylesheet" />

<script>
$("#dxSelectBox").dxSelectBox({
    placeholder: "é¸æ“‡å“¡å·¥",
    displayExpr: "name",
    valueExpr: "id",
    searchEnabled: true,
    minSearchLength: 2,
    showClearButton: true,
    pageSize: 50,          // æ¯æ¬¡åªè¼‰å…¥ 50 ç­†
    searchTimeout: 300,    // æœå°‹å»¶é² 300ms
    dataSource: new DevExpress.data.CustomStore({
        key: "id",
        load: function(loadOptions) {
            return $.getJSON("/api/employee", {
                search: loadOptions.searchValue,
                skip: loadOptions.skip || 0,
                take: loadOptions.take || 50
            });
        },
        byKey: function(key) {
            return $.getJSON("/api/employee/" + key);
        }
    })
});
</script>


<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>DataTables Custom Cell Style</title>
  <!-- DataTables CSS -->
  <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<!-- Bootstrap 5 CSS -->
<!--<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/5.0.0-alpha1/css/bootstrap.min.css" integrity="sha384-r4NyP46KrjDleawBgD5tp8Y7UzmLA05oM1iAEQ17CSuDqnUK2+k9luXQOfXJCJ4I" crossorigin="anonymous">-->
<!-- Font Awesome CSS -->
<!--<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">-->
  <style>
/* å‡åˆ† Tab å¯¬åº¦ */
.nav-tabs.nav-justified.android-top > li > a {
    text-align: center;
    padding: 10px 0;
    border: none;
    color: #555;
}
.nav-tabs.nav-justified.android-top > li.active > a,
.nav-tabs.nav-justified.android-top > li.active > a:focus,
.nav-tabs.nav-justified.android-top > li.active > a:hover {
    background: #337ab7;
    color: white;
}
.tab-content {
    padding: 15px;
    border: 1px solid #ddd;
    border-top: none;
}
.icon {
    display: block;
    font-size: 20px;
}
    /* å…¨éƒ¨ cell ç„¡æ¡†ç·š */
    .btn-label {
	position: relative;
	left: -12px;
	display: inline-block;
	padding: 6px 12px;
	background: rgba(0, 0, 0, 0.15);
	border-radius: 3px 0 0 3px;
}

.btn-labeled {
	padding-top: 0;
	padding-bottom: 0;
}
 .btnx {
	margin-bottom: -5px;
}
.btn {
	margin-bottom: 10px;
}
table.dataTable,
table.dataTable th,
table.dataTable td {
  border: none !important;
}
    /* è‡ªè¨‚ cell class */
    .custom-cell {
      background-color:#c5e1a5;
      border-radius: 10px;
      padding: 6px 12px;
      cursor: pointer;
      text-align: center;
margin:-5px;
    }
table.dataTable>thead>tr>th, table.dataTable>thead>tr>td {
    padding: 5px;
   
}
.dataTable tbody tr:hover button.custom-btn {
  background-color: #17a2b8 !important; /* åŸæœ¬çš„ btn-info é¡è‰² */
  color: #fff !important;
}
.custom-headercell {
      background-color:#c5e1a5;
      border-radius: 10px;
     padding: 5px 5px 5px 5px;   /* æ§åˆ¶å·¦å³é–“è· */ 
      cursor: pointer;
      text-align: center;
 
    }
    .custom-cell:hover {
      background-color: #c5e1a5;
    }
  </style>
</head>
<body>
<div class="container">
    <div class="row">
        <h2>
            Cool Buttons With Labels</h2>
        <div class="col-md-12">
            <button type="button" class="btn btn-labeled btn-success">
                <span class="btn-label"><i class="glyphicon glyphicon-ok"></i></span>Success</button>
            <button type="button" class="btn btn-labeled btn-danger">
                <span class="btn-label"><i class="glyphicon glyphicon-remove"></i></span>Cancel</button>
            <br />
            <button type="button" class="btn btn-labeled btn-warning">
                <span class="btn-label"><i class="glyphicon glyphicon-bookmark"></i></span>Bookmark</button>
            <button type="button" class="btn btn-labeled btn-primary">
                <span class="btn-label"><i class="glyphicon glyphicon-camera"></i></span>Camera</button>
            <br />
            <button type="button" class="btn btn-labeled btn-default">
                <span class="btn-label"><i class="glyphicon glyphicon-chevron-left"></i></span>Left</button>
            <button type="button" class="btn btn-labeled btn-default">
                <span class="btn-label"><i class="glyphicon glyphicon-chevron-right"></i></span>
                Right</button>
            <br />
            <button type="button" class="btn btn-labeled btn-success">
                <span class="btn-label"><i class="glyphicon glyphicon-thumbs-up"></i></span>Thumbs
                Up</button>
            <button type="button" class="btn btn-labeled btn-danger">
                <span class="btn-label"><i class="glyphicon glyphicon-thumbs-down"></i></span>Thumbs
                Down</button>
            <br />
            <button type="button" class="btn btn-labeled btn-info">
                <span class="btn-label"><i class="glyphicon glyphicon-refresh"></i></span>Refresh</button>
            <button type="button" class="btn btn-labeled btn-danger">
                <span class="btn-label"><i class="glyphicon glyphicon-trash"></i></span>Trash</button>
            <br />
            <a class="btn btn-success btn-labeled" href="http://www.jquery2dotnet.com" role="button">
                <span class="btn-label"><i class="glyphicon glyphicon-info-sign"></i></span>Info Web</a>
        </div>
    </div>
</div>


<div class="container">
    <!-- ä¸Šæ–¹ Tab -->
    <ul class="nav nav-tabs nav-justified android-top">
        <li class="active">
            <a data-toggle="tab" href="#home">
                <span class="icon glyphicon glyphicon-home"></span>
                Home
            </a>
        </li>
        <li>
            <a data-toggle="tab" href="#search">
                <span class="icon glyphicon glyphicon-search"></span>
                Search
            </a>
        </li>
        <li>
            <a data-toggle="tab" href="#profile">
                <span class="icon glyphicon glyphicon-user"></span>
                Profile
            </a>
        </li>
    </ul>

    <!-- Tab å…§å®¹ -->
    <div class="tab-content">
        <div id="home" class="tab-pane fade in active">
             <table id="example" class="display" style="width:100%">
    <thead>
      <tr>
        <th><div class="custom-headercell">Name</div></th>
        <th><div class="custom-headercell">Position</div></th>
        <th><div class="custom-headercell">Office</div></th>
        <th><div class="custom-headercell">Action</div></th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Tiger Nixon</td>
        <td>System Architect</td>
        <td>Edinburgh</td>
        <td>View</td>
      </tr>
      <tr>
        <td>Garrett Winters</td>
        <td>Accountant</td>
        <td>Tokyo</td>
        <td>View</td>
      </tr>
    </tbody>
  </table>
        </div>
        <div id="search" class="tab-pane fade">
            <h3>ğŸ” Search Page</h3>
            <p>é€™æ˜¯ Search çš„å…§å®¹ã€‚</p>
        </div>
        <div id="profile" class="tab-pane fade">
            <h3>ğŸ‘¤ Profile Page</h3>
            <p>é€™æ˜¯ Profile çš„å…§å®¹ã€‚</p>
        </div>
    </div>
</div>
 

  

  <!-- jQuery & DataTables -->
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
  <script>
    $(document).ready(function () {
      let table = $('#example').DataTable({
        columnDefs: [
          {
            targets: [3,2], // ç¬¬ 4 æ¬„ (Action)
            render: function (data, type, row) {
              return `<div class="custom-cell">${data}</div>`;
            }
          },{
      targets: "_all",
      orderable: false
   },
{
            targets: [0], // ç¬¬ 4 æ¬„ (Action)
            render: function (data, type, row) {
              return `  <button type="button" class="btn btn-labeled btn-info custom-btn" style="margin-bottom: -5px;margin-top:-5px;">
                <span class="btn-label"><i class="glyphicon glyphicon-refresh"></i></span>Refresh</button>`;
            }
          }
        ]
      });

      // ğŸ”¹ ç›£è½ cell é»æ“Šäº‹ä»¶
      $('#example tbody').on('click', 'td .custom-cell', function () {
        let rowData = table.row($(this).closest('tr')).data();
        alert("ä½ é»æ“Šäº†ï¼š" + rowData[0] + " çš„ Action");
      });

  // ç¶å®š click äº‹ä»¶
  $('#example').on('click', '.custom-btn', function () {
    const rowData = $('#example').DataTable().row($(this).closest('tr')).data();
    alert("You clicked info for: " + rowData[0]);
  });
    });
  </script>
</body>
</html>



$("#customerDatatable").on('click', '.img-click', function () {
    var id = $(this).data('id');
    alert("åœ–ç‰‡è¢«é»æ“Š, ID=" + id);
}); 
https://www.scaler.com/topics/bootstrap-tutorial/bootstrap-button-with-icon/
{
      data: "firstName",
      render: function (data, type, row) {
          return `
                  <img src="../img/enlarge.svg"
                       class="img-click"
                       data-id="${data}"
                       style="width:24px; height:24px; cursor:pointer;" />
                `;
      }
  }
https://codewithmukesh.com/blog/jquery-datatable-in-aspnet-core/

<div id="userSelectBox"></div>

<script>
$(function () {
    var store = new DevExpress.data.CustomStore({
        key: "id",            // ä¸»éµæ¬„ä½ (å¾Œç«¯è³‡æ–™è¦æœ‰ id)
        loadMode: "raw",      // raw = å›å‚³é™£åˆ—, ä¸éœ€è¦ { data:[], totalCount: } åŒ…è£
        load: function () {
            // é€™è£¡ç”¨ AJAX æ’ˆè³‡æ–™
            return $.ajax({
                url: "/api/User/GetUsers", // å¾Œç«¯ API
                type: "GET",
                dataType: "json"
            });
        }
    });

    $("#userSelectBox").dxSelectBox({
        dataSource: store,
        valueExpr: "id",        // å¾Œç«¯å›å‚³ç‰©ä»¶çš„ id æ¬„ä½
        displayExpr: "name",    // é¡¯ç¤ºç”¨çš„æ–‡å­—æ¬„ä½
        placeholder: "è«‹é¸æ“‡ä½¿ç”¨è€…",
        searchEnabled: true,    // é–‹å•Ÿæœå°‹
        onValueChanged: function (e) {
            console.log("é¸åˆ°çš„ä½¿ç”¨è€… ID:", e.value);
        }
    });
});
</script>public class UserController : Controller
{
    // GET: /api/User/GetUsers
    [HttpGet]
    public JsonResult GetUsers()
    {
        var users = new List<object>
        {
            new { id = 1, name = "å°æ˜" },
            new { id = 2, name = "å°è¯" },
            new { id = 3, name = "å°ç¾" }
        };

        return Json(users, JsonRequestBehavior.AllowGet);
    }
}
var store = new DevExpress.data.CustomStore({
    key: "id",
    load: function (loadOptions) {
        return $.ajax({
            url: "/api/User/GetPagedUsers",
            type: "GET",
            data: {
                skip: loadOptions.skip || 0,
                take: loadOptions.take || 10,
                search: loadOptions.searchValue || ""
            }
        });
    }
});
<div id="userSelectBox"></div>

<script>
$(function () {
    var store = new DevExpress.data.CustomStore({
        key: "id",
        load: function (loadOptions) {
            return $.ajax({
                url: "/api/User/GetPagedUsers",
                type: "GET",
                dataType: "json",
                data: {
                    skip: loadOptions.skip || 0,
                    take: loadOptions.take || 10,
                    search: loadOptions.searchValue || ""   // dxSelectBox æœå°‹ç”¨
                }
            }).then(function (data) {
                return {
                    data: data.items,         // çœŸæ­£çš„è³‡æ–™
                    totalCount: data.total    // ç¸½ç­†æ•¸ (çµ¦åˆ†é ç”¨)
                };
            });
        }
    });

    $("#userSelectBox").dxSelectBox({
        dataSource: store,
        valueExpr: "id",
        displayExpr: "name",
        searchEnabled: true,
        showClearButton: true,
        minSearchLength: 1,  // è‡³å°‘è¼¸å…¥ 1 å€‹å­—æ‰æœå°‹
        pageSize: 10,        // æ¯é  10 ç­†
        onValueChanged: function (e) {
            console.log("é¸åˆ°çš„ä½¿ç”¨è€…:", e.value);
        }
    });
});
</script>
public class UserController : Controller
{
    // æ¨¡æ“¬è³‡æ–™åº«
    private static readonly List<UserDto> Users = Enumerable.Range(1, 200)
        .Select(i => new UserDto { Id = i, Name = "ä½¿ç”¨è€…" + i })
        .ToList();

    [HttpGet]
    public JsonResult GetPagedUsers(int skip = 0, int take = 10, string search = "")
    {
        // æ¨¡æ“¬æœå°‹
        var query = Users.AsQueryable();
        if (!string.IsNullOrEmpty(search))
        {
            query = query.Where(u => u.Name.Contains(search));
        }

        // å–å‡ºç¸½ç­†æ•¸
        var total = query.Count();

        // åˆ†é 
        var items = query
            .Skip(skip)
            .Take(take)
            .ToList();

        return Json(new { items, total }, JsonRequestBehavior.AllowGet);
    }
}

public class UserDto
{
    public int Id { get; set; }
    public string Name { get; set; }
}
<div id="userSelectBox"></div>

<script>
$(function () {
    var store = new DevExpress.data.CustomStore({
        key: "id",
        load: function (loadOptions) {
            // é¡¯ç¤ºè¼‰å…¥ä¸­
            DevExpress.ui.notify("è¼‰å…¥ä¸­...", "info", 1000);

            return $.ajax({
                url: "/api/User/GetPagedUsers",
                type: "GET",
                dataType: "json",
                data: {
                    skip: loadOptions.skip || 0,
                    take: loadOptions.take || 10,
                    search: loadOptions.searchValue || ""
                }
            }).then(function (data) {
                return {
                    data: data.items,
                    totalCount: data.total
                };
            }).catch(function (err) {
                console.error("è¼‰å…¥å¤±æ•—", err);
                return { data: [], totalCount: 0 };
            });
        }
    });

    $("#userSelectBox").dxSelectBox({
        dataSource: store,
        valueExpr: "id",
        displayExpr: "name",
        searchEnabled: true,
        showClearButton: true,
        minSearchLength: 1,
        pageSize: 10,
        // dxSelectBox å…§å»º Loading Indicator
        onLoading: function() {
            $("#userSelectBox").addClass("loading");
        },
        onLoaded: function() {
            $("#userSelectBox").removeClass("loading");
        },
        onValueChanged: function (e) {
            console.log("é¸åˆ°çš„ä½¿ç”¨è€…:", e.value);
        }
    });
});
</script>

<style>
/* è‡ªè¨‚è¼‰å…¥ä¸­æ¨£å¼ */
#userSelectBox.loading {
    opacity: 0.6;
    position: relative;
}
#userSelectBox.loading::after {
    content: "â³ è¼‰å…¥ä¸­...";
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: rgba(255,255,255,0.9);
    padding: 5px 10px;
    border-radius: 5px;
    font-size: 12px;
}
</style>


