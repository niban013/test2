<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>é›™å‘é€£å‹•é¸å–®èˆ‡è¨Šæ¯</title>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  display: flex;
  height: 100vh;
}

/* å·¦å´é¸å–® */
#sidebar {
  width: 250px;
  background: #2C3E50;
  color: #ecf0f1;
  overflow-y: auto;
  padding-top: 20px;
}

/* å³å´å…§å®¹ */
#contentContainer {
  flex: 1;
  display: flex;
  flex-direction: column;
  background: #ecf0f1;
  padding: 10px;
}

/* ä¸Šæ–¹è¨Šæ¯ */
#message {
  background: #fff3cd;
  color: #856404;
  padding: 10px 15px;
  border-radius: 4px;
  margin-bottom: 10px;
  border: 1px solid #ffeeba;
  cursor: pointer;
}

/* iframe */
#contentFrame {
  flex: 1;
  width: 100%;
  border: none;
  border-radius: 6px;
}

/* é¸å–® */
.menu, .menu ul {
  list-style: none;
  margin: 0;
  padding: 0;
}

.menu li {
  position: relative;
}

.menu li > a, 
.menu li > span {
  display: block;
  padding: 12px 20px;
  color: #ecf0f1;
  text-decoration: none;
  cursor: pointer;
}

/* å±¤ç´šç¸®æ’ */
.menu ul li > a,
.menu ul li > span {
  padding-left: calc(20px + 20px * var(--level));
}

.menu li > a:hover,
.menu li > span:hover {
  background: #34495E;
}

/* å­é¸å–®éš±è— */
.menu li ul {
  display: none;
  background: #34495E;
}

/* å±•é–‹æ¨£å¼ */
.menu li.open > ul {
  display: block;
}

/* ç•¶å‰ç¯€é»é«˜äº® */
.menu li.selected > a,
.menu li.selected > span {
  background: #e67e22 !important;
}
</style>
</head>
<body>

<div id="sidebar">
  <ul id="menu" class="menu"></ul>
</div>

<div id="contentContainer">
  <div id="message">è«‹é»æ“Šå·¦å´é¸å–®æˆ–ä¸Šæ–¹è¨Šæ¯</div>
  <iframe id="contentFrame" src=""></iframe>
</div>

<script>
// ğŸ”¹ ç¯„ä¾‹è³‡æ–™
const menuData = [
  { name: "é¦–é ", url: "index.html" },
  { 
    name: "å ±è¡¨", 
    children: [
      { name: "éŠ·å”®å ±è¡¨", url: "sales.html" },
      { 
        name: "è²¡å‹™å ±è¡¨", 
        children: [
          { name: "å¹´åº¦å ±è¡¨", url: "year.html" },
          { 
            name: "å­£åº¦å ±è¡¨", 
            children: [
              { name: "Q1", url: "q1.html" },
              { name: "Q2", url: "q2.html" }
            ]
          }
        ]
      }
    ]
  },
  { 
    name: "è¨­å®š", 
    children: [
      { name: "ä½¿ç”¨è€…ç®¡ç†", url: "users.html" },
      { name: "ç³»çµ±åƒæ•¸", url: "system.html" }
    ]
  }
];

// ğŸ”¹ ç”¨ä¾†å­˜ç¯€é»å°æ‡‰ path çš„ Map
const pathMap = new Map();

// ğŸ”¹ éè¿´ç”Ÿæˆé¸å–®
function buildMenu(data, parentUl, path=[], level=0) {
  data.forEach(item => {
    const li = $("<li>");
    
    if (item.url) {
      const a = $("<a>").attr("href", "#").text(item.name);
      a.css("--level", level);
      li.append(a);

      const fullPath = path.concat(item.name).join(" > ");
      pathMap.set(fullPath, li); // è¨˜éŒ„ path å°æ‡‰ç¯€é»

      // é»æ“Šå·¦å´é¸å–®
      a.on("click", function(e){
        e.preventDefault();
        selectNode(fullPath, item.url);
      });

    } else {
      const span = $("<span>").text(item.name);
      span.css("--level", level);
      li.append(span);
    }

    if (item.children && item.children.length > 0) {
      const childUl = $("<ul>");
      buildMenu(item.children, childUl, path.concat(item.name), level + 1);
      li.append(childUl);

      // é»æ“Šå±•é–‹/æ”¶åˆï¼Œå–®ä¸€é–‹å•Ÿ
      li.children("span, a").first().on("click", function(e){
        e.preventDefault();
        li.siblings(".open").removeClass("open");
        li.toggleClass("open");
      });
    }

    parentUl.append(li);
  });
}

// ğŸ”¹ é¸æ“‡ç¯€é»ï¼ˆå·¦å´ + ä¸Šæ–¹ + iframeï¼‰
function selectNode(fullPath, url) {
  // æ›´æ–°ä¸Šæ–¹è¨Šæ¯
  $("#message").text(fullPath);

  // iframe è¼‰å…¥ URL
  if(url) $("#contentFrame").attr("src", url);

  // æ¸…é™¤æ‰€æœ‰é¸ä¸­
  $("#menu li").removeClass("selected");

  // æ¨™è¨˜ç•¶å‰ç¯€é»
  const li = pathMap.get(fullPath);
  if(li) {
    li.addClass("selected");
    // å±•é–‹çˆ¶ç¯€é»
    li.parents("li").addClass("open");
    // æ”¶èµ·åŒå±¤å…¶ä»–ç¯€é»
    li.siblings("li").removeClass("open");
  }
}

$(document).ready(function(){
  buildMenu(menuData, $("#menu"));

  // é»æ“Šä¸Šæ–¹è¨Šæ¯ä¹Ÿèƒ½è§¸ç™¼é¸å–®
  $("#message").on("click", function(){
    const currentPath = $(this).text();
    const li = pathMap.get(currentPath);
    if(li) {
      // å–å¾— URL
      const url = li.children("a").attr("href") || "";
      selectNode(currentPath, url === "#" ? "" : url);
    }
  });
});
</script>

</body>
</html>
